<mat-expansion-panel (opened)="onOpen()"
  ><mat-expansion-panel-header class="h-24"
    ><div class="grid h-12 w-full grid-cols-12">
      <span class="col-span-2"
        >{{ hit().id_ }}
        @if (hit().content.alias !== '') {
          <span>{{ hit().content.alias }}</span>
        }</span
      ><span class="col-span-10 line-clamp-2 text-ellipsis">{{
        hit().content.title
      }}</span>
    </div></mat-expansion-panel-header
  >
  <ng-template matExpansionPanelContent
    ><div class="pt-4 text-sm">
      <div class="float-right ms-6 flex flex-col gap-y-2">
        @if (hit().content.alias !== '') {
          <a
            mat-stroked-button
            [href]="'https://ega-archive.org/datasets/' + hit().content.alias"
            target="_blank"
            rel="noopener noreferrer"
            ><mat-icon>open_in_new</mat-icon>EGA Dataset</a
          >
        }
        <a mat-raised-button><mat-icon>key</mat-icon>Request Access</a>
        <a mat-raised-button><mat-icon>database_search</mat-icon>Dataset Details</a>
      </div>
      <p><strong>Dataset ID:</strong> {{ summary().accession }}</p>
      @if (hit().content.alias) {
        <p><strong>EGA ID:</strong> {{ hit().content.alias }}</p>
      }
      <p><strong>Full title:</strong> {{ summary().title }}</p>
      <p><strong>Description:</strong> {{ summary().description }}</p>
      @if (summary().type && summary().type !== []) {
        <p>
          <strong>Types: </strong>
          @for (type of summary().type; track type) {
            <mat-chip class="mr-1 text-sm">{{ type }}</mat-chip>
          }
        </p>
      }
      <div class="mb-4 mt-8 flex pe-[15%]">
        <div class="flex grow flex-col gap-y-8">
          <div class="flex">
            <div class="me-3 pt-4 text-5xl text-neutral-700">
              <mat-icon inline>book_2</mat-icon>
            </div>
            <div>
              <p>
                <strong>Part of study: </strong>
              </p>
              <p>
                {{
                  summary().studies_summary.count > 0
                    ? summary().studies_summary.stats.title
                    : 'None'
                }}
              </p>
              <p>
                <strong>Accession ID: </strong>
              </p>
              <p>
                {{
                  summary().studies_summary.count > 0
                    ? summary().studies_summary.stats.accession
                    : 'N/A'
                }}
              </p>
            </div>
          </div>
          <div class="flex">
            <div class="me-3 pt-4 text-5xl text-neutral-700">
              <mat-icon inline>genetics</mat-icon>
            </div>
            <div>
              <p><strong>Sample info:</strong></p>
              <p>
                <strong>{{ summary().samples_summary.count }}</strong> Sample{{
                  summary().samples_summary.count === 1 ? '' : 's'
                }}
                @if (summary().samples_summary.stats.sex !== []) {
                  (Sex:
                  @for (
                    sex of summary().samples_summary.stats.sex;
                    track sex.value;
                    let last = $last
                  ) {
                    {{ sex.count }} {{ sex.value }}{{ last ? ')' : ', ' }}
                  }
                }
              </p>
              <p>
                <strong>{{ summary().samples_summary.stats.tissues.length }}</strong>
                Tissue{{
                  summary().samples_summary.stats.tissues.length === 1 ? '' : 's'
                }}
              </p>
              @if (summary().samples_summary.stats.tissues.length > 0) {
                <ul class="ms-6">
                  @for (
                    tissue of summary().samples_summary.stats.tissues;
                    track tissue.value
                  ) {
                    <li>
                      <mat-chip class="mb-0.5 text-xs"
                        ><span class="uppercase">{{ tissue.value }} </span>
                        <strong>{{ tissue.count }}</strong></mat-chip
                      >
                    </li>
                  }
                </ul>
              }
              <p>
                <strong>{{
                  summary().samples_summary.stats.phenotypic_features.length
                }}</strong>
                Phenotypic Feature{{
                  summary().samples_summary.stats.phenotypic_features.length === 1
                    ? ''
                    : 's'
                }}
              </p>
              @if (summary().samples_summary.stats.phenotypic_features.length > 0) {
                <ul class="ms-6">
                  @for (
                    phenotypic_feature of summary().samples_summary.stats
                      .phenotypic_features;
                    track phenotypic_feature.value
                  ) {
                    <li>
                      <mat-chip class="mb-0.5"
                        ><span class="uppercase">{{ phenotypic_feature.value }} </span
                        ><strong>{{ phenotypic_feature.count }}</strong></mat-chip
                      >
                    </li>
                  }
                </ul>
              }
            </div>
          </div>
        </div>
        <div class="flex grow flex-col gap-y-8">
          <div class="flex">
            <div class="me-3 pt-4 text-5xl text-neutral-700">
              <mat-icon inline>description</mat-icon>
            </div>
            <div>
              <p><strong>File Summary:</strong></p>
              <p>
                <strong>{{ summary().studies_summary.count }}</strong> File{{
                  summary().studies_summary.count === 1 ? '' : 's'
                }}
              </p>
              @if (summary().files_summary.count > 0) {
                <ul class="ps-5">
                  @for (
                    format of summary().files_summary.stats.format;
                    track format.value
                  ) {
                    <li class="list-disc uppercase">
                      {{ format.value }} <strong>{{ format.count }}</strong>
                    </li>
                  }
                </ul>
              }
            </div>
          </div>

          <div class="flex">
            <div class="me-3 pt-4 text-5xl text-neutral-700">
              <mat-icon inline>experiment</mat-icon>
            </div>
            <div>
              <p><strong>Experiments Summary:</strong></p>
              <p>
                <strong>{{ summary().experiments_summary.count }}</strong> Experiment{{
                  summary().experiments_summary.count === 1 ? '' : 's'
                }}
              </p>
              <p>
                <strong
                  >{{ summary().experiments_summary.stats.experiment_methods.length }}
                </strong>
                Platform{{
                  summary().experiments_summary.stats.experiment_methods.length === 1
                    ? ''
                    : 's'
                }}
              </p>
              @if (summary().experiments_summary.stats.experiment_methods.length > 0) {
                <ul class="ps-5">
                  @for (
                    platform of summary().experiments_summary.stats.experiment_methods;
                    track platform.value
                  ) {
                    <li class="list-disc uppercase">
                      {{ platform.value | underscoreToSpace }}
                      <strong>{{ platform.count }}</strong>
                    </li>
                  }
                </ul>
              }
            </div>
          </div>
        </div>
      </div>
    </div>
  </ng-template>
</mat-expansion-panel>
