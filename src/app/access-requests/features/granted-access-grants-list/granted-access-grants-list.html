@if (hasError()) {
  <p class="text-base">There was an error retrieving your granted access requests.</p>
} @else {
  @if (isLoading()) {
    <app-stencil></app-stencil>
  } @else {
    @let grants = grantedGrants();
    @if (grants.length === 0) {
      <p class="text-base">You do not yet have access to any datasets.</p>
    } @else {
      <p class="text-base">You have the following granted access requests:</p>
      <ul>
        @for (grantedGrant of grants; track grantedGrant.grant.dataset_id) {
          @let grant = grantedGrant.grant;
          <li>
            For the dataset
            <a
              class="text-quaternary hover:text-secondary focus:text-secondary"
              routerLink="/dataset/{{ grant.dataset_id }}"
              data-umami-event="Granted Access Requests List Dataset Clicked"
              >{{ grant.dataset_id }}</a
            >
            from {{ grant.valid_from | date: friendlyDateFormat }} to
            {{ grant.valid_until | date: friendlyDateFormat }} &ndash;
            <span class="font-bold">{{ grantedGrant.daysRemaining }}</span> days left.
          </li>
        }
      </ul>
      <button
        routerLink="/work-package"
        mat-raised-button
        class="button-quaternary mt-8"
        data-umami-event="Granted Access Requests List Download Clicked"
      >
        <mat-icon fontIcon="download"></mat-icon>Set up a download token
      </button>
    }
  }
}
